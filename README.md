# DreamTracker (Android)

Приложение для записи и анализа снов. Минималистичный, спокойный интерфейс в мягкой пастельной синей гамме с поддержкой светлой/тёмной темы, плавных анимаций и удобной навигации.

## Возможности
- Запись сна голосом (AAC .m4a), прослушивание записи
- Распознавание речи системным сервисом (быстрый набросок текста сна)
- Редактируемый текст сна, автосохранение черновика
- Структурированный анализ:
  - Правила по словарю символов (`app/src/main/assets/dream_symbols.json`)
  - LLM через OpenRouter c жёстким JSON-ответом (резюме, наблюдения, рекомендации, тон, уверенность)
- Список снов: поиск по названию/тексту/тегам, избранное, разворачивание карточек по тапу
- Детали сна: краткое резюме, наблюдения, рекомендации, тон, уверенность, аудиоплеер
- Напоминания: ежедневное уведомление в заданное время
- Экспорт/импорт:
  - Экспорт всех снов в JSON и шаринг
  - Экспорт красивого отчёта за период (неделя/месяц) в PDF и PNG (градиентный фон, карточки, легенды, сетка)
  - Импорт JSON из файла
- Статистика (неделя/месяц):
  - Среднее настроение по дням (BarChart)
  - Распределение тонов (PieChart)
  - Топ символов (BarChart)
- Настройки:
  - Ввод ключа OpenRouter, автопроверка ключа/модели
  - Выбор модели (с автоподгрузкой бесплатных моделей с сайта)
  - Счётчик демо-запросов (без ключа доступно 5 анализов)
- Онбординг при первом запуске
- Плавные анимации элементов и анимированные переходы между экранами

## Установка и запуск
1. Откройте проект в Android Studio (Arctic Fox+), установите SDK 34.
2. Сгенерируйте Gradle Wrapper, если отсутствует:
   ```
   gradle wrapper --gradle-version 8.7
   ./gradlew assembleDebug
   ```
3. Добавьте ключ OpenRouter одним из способов:
   - Внутренний файл приложения на устройстве: `/data/data/com.example.dreamtracker/files/openrouter_key.txt`
   - Либо `app/src/main/assets/openrouter_key.txt` (в репозитории игнорируется)
4. Запустите на устройстве/эмуляторе (мин. Android 7.0, API 24).

Разрешения: RECORD_AUDIO, INTERNET, POST_NOTIFICATIONS (на Android 13+).

## Быстрый старт по функциям
- Запись сна: кнопка «Записать сон» на главном экране → экран записи (голос/текст, настроение, теги) → «Сохранить и проанализировать»
- Список: поиск, избранное, разворачивание карточек по тапу, кнопка «Открыть» для деталей
- Отчёт: Экран «Статистика» → «Неделя/Месяц» → «Экспорт отчёта» (PDF/PNG в `files/exports`)
- Экспорт/импорт JSON: на главном экране кнопки «Экспорт/Поделиться» и «Импорт JSON»
- Настройки: ключ OpenRouter, выбор модели, проверка ключа, загрузка бесплатных моделей, счётчик демо

## Конфигурация
- Словарь символов: `app/src/main/assets/dream_symbols.json` — редактируйте/дополняйте пары `{ "symbol": "...", "meaning": "..." }`
- Модель LLM по умолчанию: `openai/gpt-4o-mini` (настраивается в настройках)

## Приватность и хранение
- Аудио (`files/recordings/*.m4a`), экспорт (`files/exports/*`), отчёты, ключ OpenRouter — в sandbox приложения
- Настройки и черновики — в DataStore Preferences
- База данных Room (`dreamtracker.db`) хранит записи снов и результаты анализа

## Поддержка и планы
- Доп. графики и фильтры в статистике
- Мгновенный шаринг отчёта
- Кастомизация PDF (титульная страница, логотип бренда)

Подробная техническая документация: см. `TECHNICAL.md`.